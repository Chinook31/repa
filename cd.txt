
&НаСервере
Процедура ИмпортДанныхНаСервере(ПутьКФайлу)
	 ТекстДок = Новый ТекстовыйДокумент; //Создание документа
		ТекстДок.Прочитать(ПутьКФайлу); //Чтение ссылки файла
		//Перебор строк для помещения данных в массив
		Для Строка = 2 по ТекстДок.КоличествоСтрок() Цикл 
			
			ТекущаяСтрока = ТекстДок.ПолучитьСтроку(Строка);
			МассивСтр = СтрРазделить(ТекущаяСтрока,";");
			ИнфНос = Справочники.Материалы.СоздатьЭлемент();
			ИнфНос.Код = МассивСтр[0];
			ИнфНос.Наименование = МассивСтр[1];
			ИнфНос.Тип = МассивСтр[2];
			ИнфНос.Ширина = МассивСтр[3];
			ИнфНос.Длина = МассивСтр[4];			
			ИнфНос.Цена = МассивСтр[5];
			ИнфНос.Записать();  	
		КонецЦикла; 
		Сообщить("Импорт прошел успешно"); 
КонецПроцедуры


&НаСервере
Процедура ИмпортДанныхНаСервере(Файл)
	ТекстДок = Новый ТекстовыйДокумент;
	ТекстДок.Прочитать(Файл);
	Для Строка = 2 по ТекстДок.КоличествоСтрок() Цикл
		ТекущаяСтрока =  ТекстДок.ПолучитьСтроку(Строка);
		Массив = СтрРазделить(ТекущаяСтрока, ";");
		ИнфНос = Справочники.Оборудование.СоздатьЭлемент();
		ИнфНос.Код = Массив[0];
		ИнфНос.Наименование = Массив[1];
		Если Массив[2]="Сервер" Тогда
			ИнфНос.Тип = Перечисления.ТипыОборудований.Сервер;
		ИначеЕсли Массив[2]="Электрическое устройство" Тогда
			ИнфНос.Тип = Перечисления.ТипыОборудований.ЭлектрическоеУстройство;
		ИначеЕсли Массив[2]="Модем" Тогда
			ИнфНос.Тип = Перечисления.ТипыОборудований.Модем;
		ИначеЕсли Массив[2]="Роутер" Тогда
			ИнфНос.Тип = Перечисления.ТипыОборудований.Роутер;
		ИначеЕсли Массив[2]="Адаптер" Тогда
			ИнфНос.Тип = Перечисления.ТипыОборудований.Адаптер;
		КонецЕсли;
		ИнфНос.Цена = Массив[3];
		ИнфНос.Количество = Массив[4];
		ИнфНос.Записать();
	КонецЦикла;            
	Сообщить("Импорт прошел успешно")
	КонецПроцедуры


&НаКлиенте
Процедура ИмпортДанных(Команда)
	ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);  // Создаём диалоговое окно выбора файла
	ДиалогВыбора.Заголовок = "Выберите файл";
	Если ДиалогВыбора.Выбрать() Тогда      // Проверка выбора файла
		ПутьКФайлу = ДиалогВыбора.ПолноеИмяФайла;
	КонецЕсли; 
	ИмпортДанныхНаСервере(ПутьКФайлу);
КонецПроцедуры





&НаСервере
Процедура ЭкспортДанныхНаСервере(ПутьКФайлу)
	Файл = Новый ЗаписьТекста(ПутьКФайлу);
	Файл.ЗаписатьСтроку("Артикул;Наименование;Цена;");
	ЭлементыСпр = Справочники.Услуги.Выбрать();
	Пока ЭлементыСпр.Следующий() Цикл
		Файл.ЗаписатьСтроку(ЭлементыСпр.Код+";"+ЭлементыСпр.Наименование+";"+ЭлементыСпр.Цена+";");
	КонецЦикла;
	Файл.Закрыть();
	Сообщить("Экспорт прошел успешно");
КонецПроцедуры




	
&НаКлиенте
Процедура Добавить(Команда) 
	ИмяФайла = "";
	ПутьФайла = "";
	Если ПоместитьФайл(ИмяФайла, ,ПутьФайла, Истина) = Истина Тогда
		Фотография = ИмяФайла;
	ДобавитьНаСервере();
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ДобавитьНаСервере()
	НовыйФайл = Справочники.Файлы.СоздатьЭлемент();
	НовыйФайл.Изображение = Новый ХранилищеЗначения(ПолучитьИзВременногоХранилища(Фотография));
	Фотография = ПоместитьВоВременноеХранилище(НовыйФайл.Изображение.Получить());
	НовыйФайл.Записать();
	Объект.ИзображениеМ = НовыйФайл.Ссылка;
КонецПроцедуры


&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Фотография = ПолучитьНавигационнуюСсылку(Объект.ИзображениеМ,"Изображение");
	Элементы.Фотография.РазмерКартинки = РазмерКартинки.АвтоРазмер;
КонецПроцедуры







Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	Итого = Фурнитура.Итог("Сумма") + Материалы.Итог("Сумма");
КонецПроцедуры




&НаСервере
Функция Фурнитура (м) Экспорт
	x = Строка(м.Цена);
	Возврат x;
КонецФункции


&НаКлиенте
Процедура ФурнитураТоварПриИзменении(Элемент)
	СтрокаТабличнойЧасти = Элементы.Фурнитура.ТекущиеДанные;
	x = (Фурнитура(СтрокаТабличнойЧасти.Товар));
	СтрокаТабличнойЧасти.Цена = Строка(x);
КонецПроцедуры

&НаКлиенте
Процедура ФурнитураКоличествоПриИзменении(Элемент)
	СтрокаТабличнойЧасти = Элементы.Фурнитура.ТекущиеДанные;
	СтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Количество * СтрокаТабличнойЧасти.Цена; 
	Объект.Итого = Объект.Материалы.Итог("Сумма");
КонецПроцедуры 









&НаСервере
Процедура ОткрытьФайлНаСервере()
	ДокументОбъект=РеквизитФормыВЗначение("Объект");
	ДанныеФайла=Новый ДвоичныеДанные(ПутьКФайлу);
	КоличествоСтрок=ДокументОбъект.Документация.Количество();
	ДокументОбъект.Документация.Добавить();
	ДокументОбъект.Документация[КоличествоСтрок].Файл=Новый ХранилищеЗначения(ДанныеФайла, Новый СжатиеДанных(9));
	ДокументОбъект.Документация[КоличествоСтрок].ИмяФайла=ИмяФайлаДиалог;
	ДокументОбъект.Документация[КоличествоСтрок].РасширениеФайла=РасширениеФайлаИзДиалога;
	ДокументОбъект.Записать();
	ЗначениеВРеквизитФормы(ДокументОбъект, "Объект");
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФайл(Команда)
	ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);  // Создаём диалоговое окно выбора файла
	ДиалогВыбора.Заголовок = "Выберите файл";
	Если ДиалогВыбора.Выбрать() Тогда      // Проверка выбора файла
		ПутьКФайлу = ДиалогВыбора.ПолноеИмяФайла;
		//Определение имени файла и расширения файла из пути файла
		ПозицияПоследнейТочки = СтрНайти(ПутьКФайлу, ".", НаправлениеПоиска.СКонца, , 1);
		ПозицияПоследнегоСлеша = СтрНайти(ПутьКФайлу, "\", НаправлениеПоиска.СКонца, , 1); 
		
		РасширениеФайлаИзДиалога=Прав(ПутьКФайлу, СтрДлина(ПутьКФайлу)-ПозицияПоследнейТочки);
		ИмяФайлаДиалог=Сред(ПутьКФайлу,ПозицияПоследнегоСлеша+1,ПозицияПоследнейТочки-ПозицияПоследнегоСлеша-1);
		
	КонецЕсли; 
	ОткрытьФайлНаСервере();
КонецПроцедуры





ВЫБОР
	КОГДА ДокументЗаказ.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусЗаказа.Новый)
		ТОГДА 0
	КОГДА ДокументЗаказ.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусЗаказа.Отменен)
		ТОГДА 1
	ИНАЧЕ 2
КОНЕЦ




Движение.Дата = ОпределениеМесяца(Месяц(Дата));
Функция ОпределениеМесяца(Номер)
	Если(Номер) = 1 Тогда
		Возврат "Январь" КонецЕсли;
Если(Номер) = 2 Тогда
		Возврат "Февраль" КонецЕсли;
Если(Номер) = 3 Тогда
		Возврат "Март" КонецЕсли;
Если(Номер) = 4 Тогда
		Возврат "Апрель" КонецЕсли;
Если(Номер) = 5 Тогда
		Возврат "Май" КонецЕсли;
Если(Номер) = 6 Тогда
		Возврат "Июнь" КонецЕсли;
Если(Номер) = 7 Тогда
		Возврат "Июль" КонецЕсли;
Если(Номер) = 8 Тогда
		Возврат "Август" КонецЕсли;
Если(Номер) = 9 Тогда
		Возврат "Сентябрь" КонецЕсли;
Если(Номер) = 10 Тогда
		Возврат "Октябрь" КонецЕсли;
Если(Номер) = 11 Тогда
		Возврат "Ноябрь" КонецЕсли;
Если(Номер) = 12 Тогда
		Возврат "Декабрь" КонецЕсли;

КонецФункции
